---
title: 第二类斯特林数相关
date: 2019-02-25 22:52:37
tags: [组合数学]
categories: [学习笔记]
---

# 第二类斯特林数基础

## 定义

第二类斯特林数$$S(n,m)$$表示n个不同的球放到m个相同的盒子里的方案数。

## 求法

一般的求法有两种：

### 1.递推：

$$
S(n,m)=S(n-1,m-1)+m*S(n-1,m)
$$
<!--more-->

为什么呢？

我们考虑最新加进来的球放在哪，如果它自成一个盒子，那么就加上$$S(n-1,m-1)$$,还有，就是加入原有的$$m$$个盒子中的任何一个，因此要加上$$m*S(n-1,m)$$

### 2.容斥（常用方法）：

我们有这样一个式子：
$$
S(n,m)=\frac{1}{m!}\sum_{k=0}^m(-1)^kC(m,k)(m-k)^n
$$
这是什么意思呢？

我们枚举的k是指m个盒子中至少有k个空盒子，然后这k个空盒子一共有$$C(m,k)$$种方案，这样，有$$(m-k)$$个盒子可供选择。对于每一个球，一共有$$m-k$$种选择，就乘上$$(m-k)^n$$就好了。

然后，由于盒子都是相同的，所以最后的答案要除以$$m!$$。

为什么说这是一个常用方法呢？

因为这样，可以让$$S(n,m)$$变成一个卷积，就可以在$$O(nlogn)$$的时间内解决这个问题。

怎么卷积呢？

我们考虑，我们现在要求的是
$$
\frac{1}{m!}\sum_{k=0}^m(-1)^kC(m,k)(m-k)^n\\
=\sum_{k=0}^m(-1)^k*\frac{1}{m!}*\frac{m!}{(m-k)!*k!}*(m-k)^n\\
=\sum_{k=0}^m\frac{(-1)^k}{k!}*\frac{(m-k)^n}{(m-k)!}
$$
这样，很显然地，我们设
$$
f(i)=\frac{(-1)^i}{i!},g(i)=\frac{i^n}{i!}
$$
这样，我们直接求$$f*g$$就可以了。

## 性质

第二类斯特林数有一个特别重要的性质：
$$
x^n=\sum_{k=0}^{min(x,n)}S(n,k)*x^{\underline{k}}
$$
其中，
$$
x^{\underline{k}}=x*(x-1)*...*(x-k+1)
$$
称为下降幂。

而，我们又有：
$$
C(x,k)=\frac{x^{\underline{k}}}{k!}
$$
这个式子的证明就是把组合数暴力展开一下，就会发现等于右边的式子。

于是，最上面的那个式子又可以写成
$$
x^n=\sum_{k=0}^{x}S(n,k)*C(x,k)*k!
$$
考虑我们怎么证明这个鬼东西。

首先，$$x^n$$可以看成n个小球放在x个不同盒子的方案数（允许空盒），那么，我们就有：
$$
x^n=\sum_{k=0}^xS(n,k)*k!*C(x,k)
$$
这个也很好理解，就是我们枚举这x个盒子中非空的盒子有k个，那么，如果这k个盒子相同，答案就是$$S(n,k)$$，然而，问题是这k个盒子不同，所以我们就要乘以一个排列，就是乘以$$k!$$，然后，这x个盒子中还要选出k个，所以还要再乘以一个组合数$$C(x,k)$$

~~感性理解一下~~

于是，我们就发现了一个神奇的式子，而且非常有用。

再列出来给大家熟悉（背诵）一下，因为S,C都要非0，则有$$k<=n,k<=x$$，所以，最终的式子就是：
$$
x^n=\sum_{k=0}^{min(n,x)}S(n,k)*k!*C(x,k)
$$

# 第二类斯特林数应用

[BZOJ5093图的价值](https://cmwqf.github.io/2019/02/26/%E5%9B%BE%E7%9A%84%E4%BB%B7%E5%80%BC/#more)



