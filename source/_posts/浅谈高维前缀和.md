---
title: 浅谈高维前缀和
date: 2019-07-26 20:07:15
tags: [组合数学]
categories: [学习笔记]
---

# 高维前缀和

什么是高维前缀和？其实，高维前缀和是用来计算子集和的问题的，也就是
$$
ans[S]=\sum_{T\subset S}a[T]
$$
<!--more-->

# 实现原理

我们举个例子，比如我们如果要求二维前缀和，我们可以这样

```c++
for(int i = 1; i <= n; i++)
    for(int j = 1; j <= m; j++)
        a[i][j] += a[i - 1][j] + a[i][j - 1] - a[i - 1][j - 1];
```

但我们也可以这样

```c++
for(int i = 1; i <= n; i++)
    for(int j = 1; j <= m; j++) a[i][j] += a[i][j - 1];
for(int i = 1; i <= n; i++)
    for(int j = 1; j <= m; j++) a[i][j] += a[i - 1][j];
```

看起来多了一重，但实际上并非如此。

在更高维的情况下，如果采用上面的容斥方法，时间复杂度是$$O(n2^d)$$，其中$$d$$是维度。

但用后者，时间复杂度是$$O(nd)$$。

显然后者更优秀。

# 模板

给一个模板吧

```c++
for(int i = 0; i < n; i++)
    for(int j = 0; j < (1 << n); j++)
        if(j & (1 << i)) f[j] += f[j ^ (1 << i)];
```





