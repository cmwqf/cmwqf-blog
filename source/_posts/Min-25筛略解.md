---
title: Min_25筛略解
date: 2019-07-29 19:24:41
tags: [Min_25筛,数论]
categories: [学习笔记]
---

# Min_25筛

大名鼎鼎的$$Min25$$筛，是用来干什么的呢？

它是用来求积性函数前缀和$$\sum f(i)$$的，而且复杂度很优，是$$O(\frac{N^\frac{3}{4}}{log_2N})$$。使用它要满足一下几个条件：
$$
1.f是积性函数\\
2.f(p)(p\in Prime)是简单多项式形式\\
3.f(p^k)(p\in prime)可以很快地算出来
$$
<!--more-->

对于第二个条件，我的理解是如果遇到一个类似$$p^{a1}+p^{a2}+...$$，把每一项分开来算（后面的例题可以看出），这样才能算出来，也就是说，即使一个函数$$f$$是积性函数，比如$$f(p)=p-1(p\in Prime),f(ab)=f(a)f(b)$$，也不能直接拿$$f(p)=p-1$$来筛，而是把它拆成两个$$f1(p)=p,f2(p)=1$$，再来算。

# 求解g

我们考虑先设
$$
g(n,j)=\sum_{i=1}^n[i\in Prime\quad or\quad min(p)>Prime_j,p|i,p\in Prime]f(i)
$$
换句话说，$$g(n,j)$$就是$$1$$到$$n$$中是质数或最小质因子大于$$Prime_j$$的贡献和。

然后，我们计算出对于所有$$x=\lfloor\frac{n}{i}\rfloor$$的$$g(x,j)$$的值。我们考虑怎么计算转移。

1. 如果$$Prime_j^2>x$$，那么答案不会产生变化。

2. 如果$$Prime_j^2<=x$$，那么答案相较于$$g(x,j-1)$$会减少，减少的量容斥一下就好了。

后面的$$Prime_j$$用$$P_j$$表示。

$$
g(x,j)=
\begin{cases}
g(x,j-1)\quad (P_j^2>x)\\
g(x,j-1)-f(P_j)*(g(\lfloor\frac{x}{P_j}\rfloor,j-1)-\sum_{i=1}^{j-1}f(P_i))\quad (P_j^2<=x)
\end{cases}
$$

理解起来也很简单，我们要减去的，就是之前最小因子为$$P_j$$的数的$$f$$，所以，我们把$$f(P_j)$$提出来，然后，先把所有的去掉$$P_j$$的答案去掉，但是这样会多算第$$j-1$$以内的所有质数的$$f$$，减掉就好了。

然后，边界条件是什么？$$g(x,0)$$表示所有的数都当成质数带入$$f(p)$$的值之和。

最后，我们只要求出$$g(n,|P|)$$即可，根据转移的过程，我们发现$$g$$只需要开一维。

# 求解S

上一步我们求出了$$g$$。

其实，我们只需要用到$$g(n,|P|)$$这一个值，表示所有质数的$$f$$之和。

然后，我们设$$S(n,j)$$
$$
S(n,j)=\sum_{i=1}^n[min(p)>=P_j]f(i)
$$
这个怎么转移呢？我们先把质数的算出来，然后考虑合数，我们可以枚举它的最小质因子和它出现的次数，就可以转移了。
$$
S(n,j)=g(n,|P|)-\sum_{i=1}^{j-1}f(P_i)+\sum_{k=j}^{P_k^2<=n}\sum_e^{P_k^{e+1}<=n}(S(\lfloor\frac{n}{P_k^e}\rfloor,k+1)*f(P_k^e)+f(P_k^{e+1}))
$$
然后，就没有了，最后的答案就是$$S(n,1)+f(1)$$。

# 例题

[简单的函数](https://cmwqf.github.io/2019/07/29/LOJ6053-%E7%AE%80%E5%8D%95%E7%9A%84%E5%87%BD%E6%95%B0/)