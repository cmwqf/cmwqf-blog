---
title: 浅谈Min-max容斥
date: 2019-07-25 15:46:37
tags: [组合数学]
categories: [学习笔记]
---

# Min-max容斥

早就听闻Min-max容斥的大名，今天学习了一下，感觉妙不可言。

给定集合$$S$$，设$$max(S)$$为$$S$$中的最大值，$$min(S)$$为$$S$$中的最小值，那么我们可以得到：
$$
max(S)=\sum_{T\subset S}(-1)^{|T|-1}min(T)
$$
<!--more-->

举个例子：
$$
max(a,b)=min(a)+min(b)-min(a,b)\\
max(a,b,c)=min(a)+min(b)+min(c)-min(a,b)-min(b,c)-min(a,c)+min(a,b,c)
$$
我们来看一下，假设$$a<=b<=c$$，则后面那个式子右边等于
$$
a+b+c-a-b-a+a=c=max(a,b,c)
$$
是不是感觉很神奇？

**证明：**

我们考虑化简右边。

我们将集合中所有元素从小到大排好序，然后考虑每个元素的贡献。

首先，最大的那个元素贡献显然为$$1$$，因为只有只存在它本身的集合的$$min$$才是它。

那么，其他的元素的贡献是什么呢？

是它在排好序的序列中右边的数构成的所有子集（因为这样的话最小值才是它）。

当$$n$$为奇数时，我们考虑每个子集的贡献，对于任意一个子集，我们考虑它的补集，这个补集大小的奇偶性必然与这个子集相反，且每个子集和它的补集时一一对应的，所以只要有一个子集对答案有贡献，它的子集就立刻会产生相反的贡献，相互抵消，显然等式成立。

当$$n$$为偶数时（不为$$0$$），我们考虑集合中的一个数$$x$$，如果我们选的子集不包括$$x$$，剩下的数为奇数个，贡献为$$0$$，如果选了$$x$$，剩下的数还是为奇数，贡献也是$$0$$，所以等式仍然成立。

我们考虑对偶数的讨论中，我们必须要选出一个数再对剩下的数进行讨论，所以$$0$$不适用于这个证明，只有$$0$$是例外。

这样，我们就证明了结论。

其实，我们还证明了对于$$\forall n>0$$，有$$C(n,0)+C(n,2)+...=C(n,1)+C(n,3)+...$$。

# K-th Min-max容斥

我们计$$max_k(S)$$表示$$S$$中第$$k$$大的元素，那么我们有：
$$
max_k(S)=\sum_{T\subset S}(-1)^{|T|-k}C(|T|-1,k-1)min(T)
$$
# 期望的Min-max容斥

由于期望的线性性，$$min-max$$容斥适用于期望。
$$
E(max(S))=\sum_{T\subset S}(-1)^{|T|-1}E(min(T))\\
E(max_k(S))=\sum_{T\subset S}(-1)^{|T|-k}C(|T|-1,k-1)E(min(T))
$$

# 例题

[HAOI2015按位或](https://cmwqf.github.io/2019/07/25/%E6%8C%89%E4%BD%8D%E6%88%96/)

