---
title: '[BZOJ2724]蒲公英 '
date: 2019-07-26 08:07:01
tags: [分块]
categories: [BZOJ]
---

# Description

在线求静态区间众数。

给你一个长度为$n$的序列，每次询问$[l,r]$的众数是多少（如果有多个，输出最小的）。

<!--more-->

# Solution

经典的分块题，但我到现在才会。。。

首先，我们将序列分为$block$块，然后我们考虑区间众数的性质：

1. 区间众数可能是第$belong[l+1]->belong[r-1]$的众数；
2. 区间众数可能是$[l,rb[belong[l]]$或$[lb[belong[r]],r]$中的数。

这个是很显然的，因为如果一个数它既不在外面出现，也不是里面块的众数，它不可能成为整个区间的众数。

那么，我们只要处理出这两种情况就好了。怎么办呢？

首先，我们把这些数离散化一下。

然后，我们预处理两个数组：
$$
f[i][j]:从第i块到第j块的众数\\
g[i][j]:从序列开始一直到第i块数字j出现的次数
$$
我们考虑怎么预处理第一个数组，首先枚举每一个块，然后从这个块向序列末扫一遍，然后统计一下就好了（具体可以看代码）。

那么第二个呢？从头到尾扫一遍，然后更新一下，就好了。

复杂度$O(n\sqrt{n})$

然后，就没了。。。

# Code