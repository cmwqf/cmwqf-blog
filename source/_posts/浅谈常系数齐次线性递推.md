---
title: 浅谈常系数齐次线性递推
date: 2020-12-20 19:58:52
tags: [线性代数]
categories: [学习笔记]
---

# 常系数齐次线性递推

给定$$a_1,a_2,...,a_m$$以及$$f_1,f_2,...,f_m$$，对于$$\forall n>m$$，满足
$$
f_n=\sum_{i=1}^ma_if_{n-i}
$$
每次给定$$n$$，求$$f_n$$。$$n\le 10^{18}$$。

这个显然可以矩阵乘法，然而有所不同的是，这回$$m$$比较大，可能有$$m\le 500$$甚至$$m\le 30000$$，那么，普通的矩阵乘法就无法解决了。

这个时候，我们就可以使用一些技巧来加速这个过程。

<!--more-->

# 特征多项式

设$$A$$是$$n$$阶矩阵，那么如果数$$\lambda$$和非零向量$$v$$满足
$$
\lambda v=Av
$$
那么称$$\lambda$$为矩阵$$A$$的特征值，$$v$$为矩阵$$A$$的特征向量。

上式可以写成
$$
(\lambda I - A)v=0
$$
对于某个特定的$$\lambda$$，这个式子有非零$$v$$解当且仅当
$$
\det(\lambda I-A)=0
$$
把$$\lambda$$看成未知量，那么$$\det(\lambda I-A)$$可以看成关于$$\lambda$$的一个多项式，记为$$p_A(\lambda)$$，称为$$A$$的特征多项式。

显然，这个多项式应该是一个关于$$\lambda$$的$$n$$次多项式。

# Cayley-Hamilton定理

为什么要引入特征多项式的定义呢？其实就是为了这个定理做准备。

这个定理的内容很简洁：
$$
p_A(A)=O
$$
其中$$O$$是零矩阵。

如果读者感兴趣，可以自行查阅证明，此处略去。

# 原理

现在，我们就可以讲述常系数齐次线性递推的原理了。

我们想要加速矩阵快速幂的过程，那么我们的目标：对于一个矩阵$$A$$，快速算出$$A^n$$。

假设这个$$m$$阶矩阵$$A$$的特征多项式为
$$
p_A(\lambda)=\sum_{i=0}^mc_i\lambda^i
$$
由$$Cayley-Hamilton$$定理可知，
$$
p_A(A)=\sum_{i=0}^mc_iA^i=0
$$
那么我们只需要求出$$G(x)=x^n\bmod p_A(x)$$，最终的答案就是$$A^n=G(A)$$。

对于特征多项式的求法，我们可以用拉格朗日插值，但是由于常系数齐次线性递推的矩阵比较特殊，我们可以直接计算，这个我们后面再说。

假设我们已经求出了$$p_A(x)$$，那么我们只需要求出$$G(x)$$即可解决问题，因为$$G(x)$$必然是一个不超过$$m-1$$次的多项式，那么有
$$
G(x)=\sum_{i=0}^{m-1}g_ix^i\\
G(A)=\sum_{i=0}^{m-1}g_iA^i\\
f_n=\sum_{i=0}^{m-1}g_if_{m+i}
$$
因此我们可以根据$$f_m,f_{m+1},...,f_{2m-1}$$来推出$$f_n$$。

# 多项式取模

首先我们注意到要求出$$G(x)$$，我们要进行多项式取模。有$$FFT$$版的多项式取模+快速幂做法，时间复杂度$$O(m\log m\log n)$$，但是那个非常难写，考场上几乎不可能写出来。我们来介绍暴力方法。

在[多项式操作的暴力实现](https://cmwqf.github.io/2020/07/27/%E6%B5%85%E8%B0%88%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%93%8D%E4%BD%9C%E7%9A%84%E6%9A%B4%E5%8A%9B%E5%AE%9E%E7%8E%B0/)中，我介绍了如何暴力进行多项式取模，但是在此处，我们不能直接对$$x^n$$进行多项式取模，这样时间复杂度$$O(n)$$，无法接受。

我们可以考虑快速幂的思想，只不过变成在$$\bmod p_A(x)$$的情况下进行。

考虑快速幂的过程，我们把数换成多项式，并且每次让多项式先平方，再取模，这样时间复杂度为$$O(m^2\log n)$$。

# 特征多项式求法

现在，唯一的问题是如何求特征多项式。

考虑$$A$$长什么样子？
$$
A=
\begin{bmatrix}
a_1 & a_2 & a_3 & ... & a_{m-1} & a_m\\
1 & 0 & 0 & ... & 0 & 0\\
0 & 1 & 0 & ... & 0 & 0\\
... & ... & ... & ... & ... & ...\\
0 & 0 & 0 & ... & 1 & 0
\end{bmatrix}
$$
那么
$$
p_A(\lambda)=\det(\lambda I-A)=|
\begin{bmatrix}
\lambda - a_1 & -a_2 & -a_3 & ... & -a_{m-1} & -a_m\\
-1 & \lambda & 0 & ... & 0 & 0\\
0 & -1 & \lambda & ... & 0 & 0\\
... & ... & ... & ... & ... & ...\\
0 & 0 & 0 & ... & -1 & \lambda
\end{bmatrix}
|
$$
假设$$B=\lambda I - A$$，那么根据第一行展开，有
$$
\det(B)=(\lambda-a_1)B_{1,1}-a_2B_{1,2}-...-a_mB_{1,m}
$$
其中$$B_{i,j}$$表示代数余子式。

注意到$$1,i$$余子式的行列式就是其对角线上数的乘积，即$$(-1)^{i-1}\lambda^{m-i}$$，则
$$
B_{1,i}=(-1)^{1+i}(-1)^{i-1}\lambda^{m-i}=\lambda^{m-i}
$$
那么我们有
$$
\det(B)=\lambda^m-\sum_{i=1}^ma_i\lambda^{m-i}
$$


