---
title: 浅谈purfer序列
date: 2019-06-19 15:09:38
tags: [图论,生成树]
---

# 什么是purfer序列

purfer序列是用来表示一棵无根树的，一个purfer序列与一个无根树一一对应，换句话说，一个无根树对应唯一一个purfer序列，一个purfer序列也可以还原出唯一的一个无根树。

<!--more-->

# 如何构造purfer序列

对于一棵无根树，我们首先每次找到当前编号最小的叶子节点（无根树中的叶子结点指度为1），然后将其从无根树中删掉，再将所有与这个节点相连的节点编号加入purfer序列末端，不断重复这个步骤，直到最后只剩下两个节点为止。

因此，$n$个点的purfer序列长度为$n-2$。

# 如何还原无根树

如果已知一个purfer序列，我们是可以根据它还原无根树的，那么，怎么还原呢？

首先，我们把purfer序列中的每一个节点的度数设为1，然后加上每一个点在序列中出现的次数，作为这个点的度数。然后对于第i步：

先找出度数为1的所有的点中最小的那一个，设为$u$，将它与purfer序列中第i个节点$v$连边，然后将$u,v$的度数都减1。

最后，还剩下两个度数为1的点，将它们连边即可。

至于正确性，我也不会证明，知道就好了。。。

# 性质

purfer序列还有一个重要的性质：

我们考虑一个节点怎样才会被放入purfer序列里：当与它相连的节点被删除时，就会把它加进去。直到它自己被删除。

因此，我们可以得到：

**无根树中一个点的度数=这个点在purfer序列中出现的次数+1**

# 例题

[bzoj1005明明的烦恼]()