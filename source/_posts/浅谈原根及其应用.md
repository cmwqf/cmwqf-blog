---
title: 浅谈原根及其应用
date: 2020-01-08 23:18:50
tags: [数论]
categories: [学习笔记]
---

# 原根

要想了解原根，先了解什么是阶。

数论中，阶一般定义为对于两个互质的整数$$a,p$$，使得$$a^r\equiv 1\pmod {p}$$的最小的正整数$$r$$，称为$$a$$模$$p$$的阶。

而原根，就是定义在阶的基础上的：

如果一个数$$1<g<p$$，且$$g$$模$$p$$的阶是$$\phi(p)$$，那么$$g$$就称为$$p$$的原根。

如果$$p$$是质数，那么就有$$g$$模$$p$$的阶为$$p-1$$。

<!--more-->

# 原根的性质

原根有什么性质？
以下我们都讨论$$p$$为质数的情况，合数则只要把$$p-1$$换成$$\phi(p)$$即可。

**对于$$\forall 1 \le i,j \le p-1,i\neq j$$，都有$$g^i\not\equiv g^j \pmod{p}$$。**

证明：

考虑反证法，如果存在$$1\le i,j\le p-1,i\neq j$$，有$$g^i\equiv g^j\pmod{p}$$，不妨设$$i<j$$，那么就有$$g^{j-i}\equiv 1\pmod{p}$$，而$$0<j-i<p-1$$，这与原根的定义矛盾，所以假设不成立。

证毕。

这是一个非常好的性质，为后面作为单位根做铺垫。

# 原根的应用

单位根。

复数的单位根，指的是将$$2\pi$$平均分为$$k$$份，而复数$$(cos(\frac{2\pi}{k}),sin(\frac{2\pi}{k}))$$就是单位根，记为$$w_k$$。它有什么性质呢？

由其在复平面上的性质，我们可以发现$$w_k^i,0\le i\le k-1$$两两不同（考虑在单位圆中旋转，每次旋转$$\frac{2\pi}{k}$$，在此范围内不会重合）。而$$FFT$$也是利用了这个性质（将$$n$$个不同的数带入多项式，将多项式转为点值表示法）。

那么，在模意义下的单位根，原根就派上了用场。

记$$w_k=g^{\frac{p-1}{k}}$$，前提是$$k|p-1$$，这也是$$NTT$$模数必须是$$2^mp+1$$的形式的重要原因（也因此，$$NTT$$不能处理长度为$$1e7$$的数列，因为这样会使$$k$$过大而无法满足$$k| p - 1$$)。

**那么，我们依然有$$0\le i\le k-1,w_k^i$$两两不同。**

证明也很显然，因为$$\frac{i(p-1)}{k}<p-1$$，根据原根的性质，必然是两两不同的。

这也是$$NTT$$所依赖的性质。

# 例题

如果我们要求某个值，给定$$n,k,p$$,且保证$$k|p-1$$，求
$$
\sum_{i=0}^n[k|i]F(i)\mod{p}
$$
怎么办？

意思就是说，当$$k|i$$时才对答案产生贡献，否则不产生贡献。

那么我们要构造一个函数，使得当$$k|i$$时，这个函数值为$$1$$，否则为$$0$$。

考虑单位根$$w_k=g^{\frac{p-1}{k}}$$，构造
$$
\sum_{j=0}^{k-1}w_k^{ij}
$$
可以发现，如果$$k|i$$，那么每一项都是$$1$$，这个数就等于$$k$$。

否则，根据等比数列求和，它等于
$$
\frac{w_k^{ki}-1}{w^i-1}=\frac{1-1}{w^i-1}=0
$$
这样，
$$
\frac{1}{k}\sum_{j=0}^{k-1}w_k^{ij}
$$
就能完美地满足我们的要求了。

是不是很巧妙呢？