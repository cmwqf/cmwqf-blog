---
title: 一个人的数论
date: 2019-06-26 09:54:27
tags: [数论]
categories: [BZOJ]
---

# Description

求
$$
fk(n)=\sum_{i=1}^n[gcd(i,n)=1]*i^m
$$
给出
$$
n,1<=w<=1000,1<=ai,pi<=10^9\\
n=\prod_{i=1}^wpi^{ai}
$$

<!--more-->

# Solution

先推式子
$$
fk(n)=\sum_{i=1}^ni^m*\sum_{d|gcd(i,n)}\mu(d)\\
=\sum_{d|n}\mu(d)*\sum_{i=1}^{n/d}(id)^m\\
=\sum_{d|n}\mu(d)*d^m*\sum_{i=1}^{n/d}i^m
$$
先看后面那个是前缀m次和的形式，考虑怎么推那个东西

这里有一个知识点，伯努利数，如果没有学过出门右转：

[伯努利数相关](https://cmwqf.github.io/2019/06/26/%E4%BC%AF%E5%8A%AA%E5%88%A9%E6%95%B0%E7%9B%B8%E5%85%B3/#more)

这样原式就可以写成
$$
fk(n)=\sum_{d|n}\mu(d)*d^m*\frac{1}{m+1}*\sum_{k=0}^{m}C(m+1,k)*B_k*(\frac{n}{d})^{m+1-k}\\
设a[i]=\frac{1}{m+1}*C(m+1,m+1-i)*B_{m+1-i}\\
fk(n)=\sum_{d|n}\mu(d)*d^m*\sum_{i=1}^{m+1}a[i]*(\frac{n}{d})^i\\
=\sum_{i=1}^{m+1}a[i]*\sum_{d|n}\mu(d)*d^m*(\frac{n}{d})^i\\
=\sum_{i=1}^{m+1}a[i]*n^i*\sum_{d|n}\mu(d)*d^{m-i}\\
$$
狄利克雷卷积有一个性质：
$$
如果f,g为积性函数，则f*g也是积性函数
$$
证明如下：
$$
设h=f*g，gcd(n,m)=1(不完全积性函数)，则\\
h(n)h(m)=\sum_{d|n}f(d)*g(\frac{n}{d})\sum_{p|m}f(p)*g(\frac{m}{p})\\
=\sum_{d|n}\sum_{p|m}f(dp)*g(\frac{nm}{dp})\\
=\sum_{dp|mn}f(dp)*g(\frac{nm}{dp})\\
=h(nm)
$$
则
$$
h(n)=\sum_{d|n}\mu(d)*d^{m-i}为积性函数
$$
所以我们只需考虑$h(p^a)$就可以了
$$
h(p^a)=\sum_{j=0}^a\mu(p^j)*p^{jm-ij}
$$
只有当$j=0/1$时才会有贡献，因此
$$
h(p^a)=1-p^{m-i}
$$
因此，
$$
h(n)=(1-p_1^{m-i})*...*(1-p_w^{m-i})
$$
即
$$
ans=\sum_{i=1}^{m+1}a[i]*n^i*\prod_{j=1}^w(1-p_j^{m-i})\\
a[i]=\frac{1}{m+1}*C(m+1,m+1-i)*B_{m+1-i}
$$


这样，就结束了。。。

# Code



