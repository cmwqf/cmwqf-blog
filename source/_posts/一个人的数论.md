---
title: 一个人的数论
date: 2019-06-26 09:54:27
tags: [数论]
categories: [BZOJ]
---

# Description

求
$$
fk(n)=\sum_{i=1}^n[gcd(i,n)=1]*i^m
$$
给出
$$
n,1<=w<=1000,1<=ai,pi<=10^9\\
n=\prod_{i=1}^wpi^{ai}
$$

# Solution

先推式子
$$
fk(n)=\sum_{i=1}^ni^m*\sum_{d|gcd(i,n)}\mu(d)\\
=\sum_{d|n}\mu(d)*\sum_{i=1}^{n/d}(id)^m\\
=\sum_{d|n}\mu(d)*d^m*\sum_{i=1}^{n/d}i^m
$$
先看后面那个是前缀m次和的形式，考虑怎么推那个东西

这里有一个知识点，伯努利数，如果没有学过出门右转：

[伯努利数相关]()

