---
title: 浅谈数论相关
date: 2019-02-20 19:09:48
tags: [数论]
---

# 数论函数

## 莫比乌斯函数

## 欧拉函数

## 其他函数



# 重要公式

跟$\phi,\mu$有关的公式如下：
$$
\sum_{d|n}\mu(d)=[n=1]（莫比乌斯反演的根本）\\
\sum_{d|n}\phi(d)=n\\
1*\mu=e\\
1*\phi=id\\
\mu*id=\phi\\
(f*g)(n)=\sum_{d|n}f(d)*g(\frac{n}{d})\\
$$


# 例题

1.[简单数学题](https://www.luogu.org/problemnew/show/P3768)

在此膜zzq大佬一发。

题意：求
$$
\sum_{i=1}^n\sum_{j=1}^nijgcd(i,j)\quad mod\quad p
$$
~~这种数论题，一看就知道要推式子的~~

sol:

我们开始大力推式子：

根据以往经验，我们这样变形：
$$
\sum_{d=1}^nd*\sum_{i=1}^n\sum_{j=1}^nij*[gcd(i,j)==d]\\
\sum_{d=1}^nd^3*\sum_{i=1}^{n/d}\sum_{j=1}^{n/d}ij*[gcd(i,j)==1]\\
$$
这就是把后面的i,j都除以d，这样，在前面要把补回来，于是就出现了$d^3$

有莫比乌斯反演可得：
$$
\sum_{d=1}^nd^3*\sum_{i=1}^{n/d}\sum_{j=1}^{n/d}ij\sum_{p|i,p|j}\mu(p)
$$
接下来的式子，理解起来有些困难（可能是我太弱了）：我们将p的枚举提到前面来，并且枚举原来的i,j分别是p的多少倍：
$$
\sum_{d=1}^nd^3*\sum_{p=1}^{n/d}\mu(p)\sum_{i=1}^{n/(pd)}\sum_{j=1}^{n/(pd)}(i*p)*(j*p)
$$
此处的i,j枚举的是原来的i,j是p的多少倍，而此处的$i\times p,j\times p$才是原来的i和j（可能有点绕，多读几遍就好了）。接下来，我们可以将两个p提到前面来：
$$
\sum_{d=1}^nd^3*\sum_{p=1}^{n/d}\mu(p)*p^2\sum_{i=1}^{n/(pd)}\sum_{j=1}^{n/(pd)}i*j
$$
而
$$
\sum_{i=1}^{n/(pd)}\sum_{j=1}^{n/(pd)}i*j=（1+2+...+\frac{n}{pd})^2
$$
所以，原式就变成了：
$$
\sum_{d=1}^nd^3*\sum_{p=1}^{n/d}\mu(p)*p^2*(1+2+...+\frac{n}{pd})^2
$$
我们设$T=pd$（也是套路）,再换一种枚举方式，并把提到最前面，并设：
$$
sum(n)=1+2+...+n
$$

$$
\sum_{T=1}^nsum(\frac{n}{T})^2\sum_{d|T}d^3*(\frac{T^2}{d^2})*\mu(\frac{T}{d})\\
\sum_{T=1}^nsum(\frac{n}{T})^2\sum_{d|T}d*T^2*\mu(\frac{T}{d})\\
\sum_{T=1}^nsum(\frac{n}{T})^2*T^2\sum_{d|T}d*\mu(\frac{T}{d})\\
$$
根据之前的结论，我们有：
$$
\mu*id=\phi
$$
而巧合的是：
$$
\sum_{d|T}d*\mu(\frac{T}{d})=\sum_{d|T}id(d)*\mu(\frac{T}{d})=(\mu*id)(T)=\phi(T)
$$
所以，原式就变成了：
$$
\sum_{T=1}^nsum(\frac{n}{T})^2*T^2*\phi(T)
$$
由于$sum(\frac{n}{T})^2$可以用整除分块和预处理算出，所以我们要用杜教筛算的就是：
$$
\sum_{T=1}^nT^2*\phi(T)
$$
