---
title: 浅谈Matrix-Tree定理
date: 2019-02-03 11:00:27
tags: [线性代数]
categories: [学习笔记]
---

# 行列式的定义

行列式指一个$$n$$阶方阵（行数和列数相等）的值，记为$$det(A)$$或$$|A|$$。

求行列式的公式为:
$$
det(K)=\sum_P((-1)^{T(P)}*K_{1,p1}...*K_{n,pn})
$$
其中，$$P$$为$$1,..,N$$任意的一个排列，$$T(P)$$表示排列$$P$$的逆序对数，那个求和式的每一项就是从矩阵中选出$$n$$个数，使他们的行列都不重合。

<!--more-->

# 性质

1. 交换矩阵的两行（列），行列式变号

2. 如果矩阵有两行（列）完全相同，则行列式为$$0$$

3. 如果某一行（列）都乘以同一个数$$k$$，那么新行列式的值等于原行列式的值乘$$k$$

4. 如果矩阵有两行（列）成比例（比例系数为$$k$$），那么行列式为$$0$$

5. 如果把矩阵某一行（列）加上另一行（列）的$$k$$倍，行列式的值不变

# 求法

对于一个行列式，我们根据**性质5**，将它转化为一个上三角矩阵（左下半部分全是0），那么，**其行列式的值就等于对角线上数的乘积**（带入求行列式公式即证）。

这样，我们通过高斯消元的办法，把一个矩阵化成这个形式，再把对角线乘起来就可以了。

# Matrix-Tree定理无向图形式

这是一个计算一个无向图的生成树个数的定理，它的计算规则如下：

设$$D$$为度数矩阵，其中
$$
D[i][j]=0(i\ne j),D[i][i]=deg[i]
$$
设$$A$$为邻接矩阵。

定义**基尔霍夫矩阵**$$K=D-A$$

那么，最后的答案就是$$K$$在$$(i,i)$$处的余子式。

实际上，$$Matrix-Tree$$定理本质上是在求
$$
\sum_{T}\prod_{e\in T}val_e
$$
其中，$$T$$是生成树，$$e$$是边。换句话说，这个定理本质上是求这张图中所有生成树边权乘积之和，如果我们只是想求生成树的个数，只需要把每条边边权设成$$1$$即可。

否则，邻接矩阵$$(i,j)$$存的是所有$$(i,j)$$边的边权和，度数矩阵$$(i,i)$$存的是所有与$$i$$相邻的边的边权和。

# Matrix-Tree定理有向图形式

有向图的生成树分为两种：内向树和外向树。

内向树指树上所有的边都是孩子指向父亲，外向树则是所有边都是父亲指向儿子。

那么，设$$D_{out}$$表示所有点的出度矩阵，$$D_{in}$$表示所有点的入度矩阵，换句话说
$$
D_{out}[i][i]=\sum_{(u,v)\in E,u=i}val[u][v]\\
D_{in}[i][i]=\sum_{(u,v)\in E,v=i}val[u][v]
$$
此时，内向树的基尔霍夫矩阵为$$K_{out}=D_{out}-A$$，外向树为$$K_{in}=D_{in}-A$$。如果我们想要求出以$$rt$$为根的内向树（外向树）个数，那么只需要求$$K_{out}$$（$$K_{in}$$）在$$(rt,rt)$$处的余子式即可。

鉴于内向树和外向树到底哪个是$$K_{in}$$，哪个是$$K_{out}$$，总是容易混淆。可以这样记忆：

内向树，内为$$in$$，然而它的基尔霍夫矩阵恰好相反，为$$K_{out}$$。

外向树，外为$$out$$，然而它的基尔霍夫矩阵也恰好相反，为$$K_{in}$$。