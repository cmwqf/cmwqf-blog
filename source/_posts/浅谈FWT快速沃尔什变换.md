---
title: 浅谈FWT快速沃尔什变换
date: 2019-07-06 23:05:27
tags: [多项式]
---

# 快速沃尔什变换

FWT与FFT类似，只不过是进行集合卷积的计算，如：
$$
C_k=\sum_{i\oplus j = k} A_i*B_j\\
其中\oplus是位运算,可以是与,或,异或等
$$
<!--more-->

# 或(or)运算的FWT

我们考虑或的FWT，如果我们有一个集合$A_i$，设$FWT(A)=A'$那么$A'_i$的意义就是这个集合所有子集的贡献之和。
$$
A'_i=\sum_{i|j=i}A_j
$$
这样，因为$k|(i|j)=k$可以推出$k|i=k,k|j=k$我们可以得到一个结论：
$$
C'_k=\sum_{k|t=k}C_t=\sum_{k|t=k}\sum_{i|j=t}A_i*B_j=\sum_{k|(i|j)=k}A_i*B_j\\
=(\sum_{k|i=k}A_i)*(\sum_{k|j=k}B_j)=A'_k*B'_k
$$
这样我们来看$A'$是怎么求的。

我们考虑吧$A$长度补为$2^k$，分为两半，$A0$是前面一半，表示第一位是0，$A1$是后面一半，表示第一位是1。

然后，我们也把$A'$分为两半来考虑，前面一半是第一位是0，那么它的子集就是$A0'$（它本身），后面一半第一位是1，它的子集既有$A1‘$(它本身)，还有$A0’$。

所以
$$
A'=merge(A0',A0'+A1')
$$
其中，$merge$就是将两个数组拼接在一起，$+$表示对应下标的数相加。

这样我们就能在$O(nlogn)$的复杂度内求出了$FWT(A)$。

这样，我们就可以算出$FWT(C)$，那么，我们怎么把$FWT(C)$转回来呢？

现在，问题变成了反过来，我们现在知道了$A0',A1'$，又因为$A0‘=A0,A1'=A0+A1$，

所以，



