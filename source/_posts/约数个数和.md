---
title: 约数个数和
date: 2019-02-21 17:33:29
tags: [数论]
---

[约数个数和](https://www.luogu.org/problemnew/show/P3327)

题意：求
$$
\sum_{i=1}^n\sum_{j=1}^md(ij)\\
d(n)指的是n的约数个数
$$
<!--more-->

sol:

首先，我们要知道这个式子，不然整个题目就无从下手：
$$
d(ij)=\sum_{x|i}\sum_{y|j}[gcd(x,y)==1]
$$
证明如下：
$$
若i=p_1^{a_1}*p_2^{a_2}...,j=p_1^{b_1}p_2^{b_2}...则ij=p_1^{a_1+b_1}p_2^{a_2+b_2}...\\
如果x|i,y|j,且gcd(x,y)==1。x=p_1^{c_1}*p_2^{c_2}...,y=p_1^{d_1}*p_2^{d_2}...\\
对于一个p_t,x中c_t和y中d_t必有一个为0。\\
如果c_t=0,则d_t有b_t+1种取值，反过来，如果d_t=0,则c_t有a_t+1种可能性，\\
也就是说，对于一个p_t,有a_t+b_t+2-1=a_t+b_t+1种可能(减1是去掉两个都是0的情况)\\
如此，共有\prod_{i}(a_i+b_i+1)中可能，而ij的约数个数和也恰好等于这个式子，所以成立。
$$
有了这个式子以后，我们就开始大力推式子了：

