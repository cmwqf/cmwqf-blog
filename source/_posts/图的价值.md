---
title: 图的价值
date: 2019-02-26 22:49:13
tags: [组合数学,多项式]
---

[BZOJ5093图的价值](https://www.lydsy.com/JudgeOnline/problem.php?id=5093)

很容易地，我们可以推出这么一个式子：
$$
ans=n*2^{C(n-1,2)}*\sum_{i=0}^{n-1}C(n-1,i)*i^k
$$
<!--more-->

这个式子的意思就是，我们枚举每一个点向外连的度数，假如度数是$i$,就一共有$C(n-1,i)$种它连接外面的方案，而另外$n-1$个点可以随便练，然后再乘上一个自己的贡献，就是：
$$
ans=n*\sum_{i=0}^{n-1}C(n-1,i)*2^{C(n-1,2)}*i^k=n*2^{C(n-1,2)}*\sum_{i=0}^{n-1}C(n-1,i)*i^k
$$
主要，我们要计算的，就是
$$
\sum_{i=0}^{n-1}C(n-1,i)*i^k
$$
根据第二类斯特林数，这个式子可以变形为：
$$
\sum_{i=0}^{n-1}C(n-1,i)*\sum_{j=0}^iS(k,j)*j!*C(i,j)\\
=\sum_{j=0}^{n-1}S(k,j)*j!*\sum_{i=j}^{n-1}C(n-1,i)*C(i,j)\\
$$
众所周知，
$$
C(n-1,i)*C(i,j)=C(n-1,j)*C(n-1-j,i-j)
$$
所以，式子变成了
$$
\sum_{j=0}^{n-1}S(k,j)*j!*\sum_{i=j}^{n-1}C(n-1,j)*C(n-1-j,i-j)\\
=\sum_{j=0}^{n-1}S(k,j)*j!*C(n-1,j)*\sum_{i=j}^{n-1}C(n-1-j,i-j)\\
=\sum_{j=0}^{n-1}S(k,j)*j!*C(n-1,j)*\sum_{i=0}^{n-j-1}C(n-j-1,i)\\
=\sum_{j=0}^{n-1}S(k,j)*j!*C(n-1,j)*2^{n-j-1}
$$
所以，
$$
ans=n*2^{C(n-1,2)}*\sum_{i=0}^{n-1}S(k,i)*i!*C(n-1,i)*2^{n-i-1}\\
=n*2^{C(n-1,2)}*\sum_{i=0}^{min(n-1,k)}S(k,i)*i!*C(n-1,i)*2^{n-i-1}
$$
我们用NTT求出S，然后再搞一搞就好了。

emm...

NTT求S：
$$
S(n,m)=\sum_{i=0}^m\frac{(-1)^i}{i!}*\frac{(m-i)^n}{(m-i)!}
$$
上代码：

