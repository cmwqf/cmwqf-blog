---
title: 浅谈快速傅里叶变换FFT
date: 2020-03-08 17:22:12
tags: [生成函数]
categories: [学习笔记]
---

# 快速傅里叶变换

在$$OI$$中，快速傅里叶变换一般是用来解决多项式乘法（卷积）问题的，什么是卷积？

设有两个函数$$F(x),G(x)$$，那么
$$
H[n]=(F*G)[n]=\sum_{i=0}^n F[i]*G[n-i]
$$
一般来说，暴力计算这个$$H$$是$$O(n^2)$$的，快速傅里叶变换可以将这个过程复杂度降低为$$O(nlog_2n)$$。

<!--more-->

# 多项式点值表示法

我们一般见到的多项式是系数表示法，即
$$
F(x)=a_0+a_1x+a_2x^2+...
$$
我们知道，一个$$n$$次多项式可以由$$n+1$$个不同点唯一确定，那么我们将这$$n+1$$个点$$(x_i,F(x_i))$$看成这个多项式的点值表示法。

而对于点值表示法进行多项式乘法却异常地简单，只需将两个多项式点值表示法中横坐标相同的点的纵坐标相乘即可，复杂度线性。

但是，一般题目中给我们的都是系数表示法，暴力转化成点值表示法依然是$$O(n^2)$$的。实际上，快速傅里叶变换就是加速将多项式**系数表示法**转化为**点值表示法**的过程，将其的复杂度降为$$O(nlog_2n)$$。

# 复数相关

因为多项式点值表示法并不唯一，我们假设多项式次数为$$n-1$$，那么带入任意的$$n$$个$$x$$都可以得到一组点，那么，我们考虑将$$n$$个单位根$$w_n^0,w_n^1...w_n^{n-1}$$带入，得到不同的点值。

那么，单位根是什么？我们从头讲起。

## 复数

单位根是定义在复数意义上的，复数是形如$$a+bi(a,b\in R,i=\sqrt{-1})$$的形式的数，对应复平面上的$$(a,b)$$的向量。

模长：复数的模长定义为$$\sqrt{a^2+b^2}$$，即该复数在复平面上对应向量到原点的距离。

## 复数基本运算

复数加减：$$(a+bi)+(c+di)=(a+c)+(b+d)i$$。

复数乘法：$$(a+bi)(c+di)=(ac-bd)+(ad+bc)i$$（可以暴力展开，将$$i^2$$看成$$-1$$即可）。

复数相乘，在复平面上的意义为**模长相乘，辅角相加**。

## 共轭复数

我们称$$a+bi$$和$$a-bi$$为共轭复数，在复平面上，可以看成关于$$x$$轴对称的两个向量。

## 单位根

单位根，就是满足$$z^n=1$$的复数（可以看作将复平面上单位圆平均分为$$n$$个部分的单位复数），记为$$w_n$$。

$$n$$次单位根，就是将单位圆平分为$$n$$个部分的$$n$$个向量对应的复数。依次记为$$w_n^0,w_n^1,w_n^2...w_n^{n-1}$$。

我们记$$w_n$$的辅角为$$\theta=\frac{2\pi}{n}$$，那么每次$$w_n^k->w_n^{k+1}$$在图像上的意义就是$$w_n^k$$逆时针旋转$$\theta$$得到的向量。

考虑单位根的时候，一般放在复平面中考虑，更容易理解。

## 单位根性质

性质$$1$$：$$w_{2n}^{2k}=w_n^k$$，这个根据复平面上的平分单位圆的概念很直观，不作解释。

性质$$2$$：$$w_n^{k+\frac{n}{2}}=-w_n^k$$，相当于将$$w_n^k$$逆时针转$$\pi$$得到$$w_n^{k+\frac{n}{2}}$$，自然横纵坐标都取反。

实际上，$$FFT$$就是根据这两个简单的性质进行的。

# FFT的原理

首先，我们将整个多项式次数补为$$2^t-1$$的形式（$$2^t>2n$$），设$$lim=2^t$$，那么相当于多项式乘法在模$$x^{lim}$$意义下进行，多余的项系数为$$0$$，以保证后面每次使$$lim/2$$后都是整数。

## DFT

所谓$$DFT$$，就是把系数转化为点值的方法。

我们现在要把$$w_n^0,w_n^1,...w_n^{n-1}$$带入多项式，计算其点值。

我们令$$m=\frac{n}{2}$$，因为$$n$$是$$2$$的整数次幂，所以$$m$$也一定是整数。

我们设
$$
A(w_n^k)=\sum_{i=0}^{n-1}a[i]w_n^i
$$
注意，这里的$$a[i]$$和原来多项式中的$$a[i]$$不同，只是由上一层递归下来得到的$$n$$个数，后面我们会知道是什么。

那么，对于$$k<\frac{n}{2}$$，即$$k<m$$，我们有
$$
A(w_n^k)=\sum_{i=0}^{n-1}a[i](w_n^{k})^i\\
=\sum_{i=0}^{m-1}a[2i](w_n^k)^{2i}+\sum_{i=0}^{m-1}a[2i+1](w_n^k)^{2i+1}\\
=\sum_{i=0}^{m-1}a[2i]w_n^{2ki}+\sum_{i=0}^{m-1}a[2i+1]w_n^{2ki+k}\\
=\sum_{i=0}^{m-1}a[2i]w_{2m}^{2ki}+w_n^k\sum_{i=0}^{m-1}a[2i+1]w_{2m}^{2ki}
$$
根据上面所说的性质一，$$w_{2n}^{2i}=w_n^i$$可知
$$
A(w_n^k)=\sum_{i=0}^{m-1}a[2i]w_m^{ki}+w_n^k\sum_{i=0}^{m-1}a[2i+1]w_m^{ki}
$$
又由性质三，我们可以知道：
$$
A(w_n^{k+\frac{n}{2}})=(-1)^{\frac{n}{2}}\sum_{i=0}^{m-1}a[2i]w_m^{ki}+(-1)^{\frac{n}{2}}w_n^{k+\frac{n}{2}}\sum_{i=0}^{m-1}a[2i+1]w_m^{ki}\\
=\sum_{i=0}^{m-1}a[2i]w_m^{ki}-w_n^k\sum_{i=0}^{m-1}a[2i+1]w_m^{ki}
$$
我们递归到下一层的时候分别**分治偶数项和奇数项**计算对应的点值，设为$$A_0,A_1$$，那么显然有
$$
A(w_n^k)=A_0(w_\frac{n}{2}^k)+w_n^kA_1(w_{\frac{n}{2}}^k)\\
A(w_n^{k+\frac{n}{2}})=A_0(w_\frac{n}{2}^k)-w_n^kA_1(w_{\frac{n}{2}}^k)
$$
那么，实际上我们每次递归到的一层的$$a$$是上一层$$a$$的奇数项或偶数项。

这样，时间复杂度是$$O(nlog_2n)$$。

由于递归效率不高，所以一般采用迭代的方式来实现这个过程，即注意到多项式的$$i$$次项到分治边界时的下标为$$r[i]$$，$$r[i]$$是$$i$$二进制翻转后的数，所以我们每次从下往上迭代即可。

## IDFT

